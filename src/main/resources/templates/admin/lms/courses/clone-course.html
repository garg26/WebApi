<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<!--/*/ <th:block th:include="admin/head"></th:block> /*/-->

<body>

<div id="wrapper">

  <!--/*/ <th:block th:include="admin/navigation"></th:block> /*/-->


  <div id="page-wrapper">
    <div class="panel-body">
      <div class="row">
        <div class="col-lg-12">
          <h1 th:inline="text" class="page-header">[[${title}]]</h1>
        </div>
      </div>
      <form role="form" name="cloneCourse" id="cloneCourse">
        <div class="row">
          <div class="col-md-6">

            <div class="form-horizontal">
              <div class="row">

                <div class="">

                  <div class="col-sm-12">
                    <label>Title</label> <input type="text" name="courseTitle"
                                                id="courseTitle" class="form-control"
                                                th:value="${course?.courseTitle}"
                                                placeholder="course title eg Pub AD.." autofocus
                                                maxlength="255" required>
                  </div>

              <!--    <div class="col-sm-6">
                    <label>Name</label> <input type="text" name="courseName"
                                               id="courseName" class="form-control"
                                               th:value="${course?.courseName}"
                                               onkeyup="generateSlug(this.value,'course');"
                                               placeholder="course Name eg Geography optional.."
                                               maxlength="255">
                  </div>-->
                </div>
              </div>
            </div>


            <label style="margin-top: 10px">Slug(URL)</label>
            <div class="input-group">

              <span class="input-group-addon" id="slug-name">https://neostencil.com/course/</span>

              <input id="slug" type="text" class="form-control" name="slug"
                     th:value="${course?.courseOldSlug}" placeholder="slug..."
                     onkeypress="slugExistence(event,this.value,'course')"
                     maxlength="255">
            </div>
            <div id="errMsg"></div>

            <div class="form-group">
              <label style="margin-top: 10px" ;>Institute</label> <select
                name="teacherInstitute" required id="teacherInstitute"
                class="form-control selectpicker" data-live-search="true"
                title="Select Institute">


              <option th:each="institute : ${institutes}"
                      th:data-subtext="${institute.id}" th:text="${institute.name}"
                      th:selected="${course?.institute?.name == institute?.name}"
                      th:value="${institute.id}"></option>

            </select>
            </div>

            <div class="form-group">
              <label>Teacher(s)</label> <select name="courseInstructorId"
                                                required multiple id="courseInstructorId"
                                                class="form-control selectpicker"
                                                data-live-search="true"
                                                title="Select Multiple Teacher">


              <option th:each="instructor : ${course.instructors}"
                      th:data-subtext="${instructor.id}"
                      th:text="${instructor.teacherName}"
                      th:value="${instructor.id}" th:selected="${instructor?.id}"></option>

            </select>

            </div>


            <div class="form-group">
              <label>Course Type</label> <select name="courseType" required
                                                 id="courseType" class="form-control">
              <option value="0" disabled selected>Select Course Type</option>

              <option value="LECTURES_ONLY"
                      th:selected="${#strings.toString(course?.courseType)} == 'LECTURES_ONLY'">
                Lecture Only
              </option>
              <option value="TEST_SERIES_ONLY"
                      th:selected="${#strings.toString(course?.courseType)} == 'TEST_SERIES_ONLY'">
                Test Series Only
              </option>
              <option value="LECTURES_TESTSERIES"
                      th:selected="${#strings.toString(course?.courseType)} == 'LECTURES_TESTSERIES'">
                Lecture TestSeries
              </option>
              <option value="INTERVIEW"
                      th:selected="${#strings.toString(course?.courseType)} == 'INTERVIEW'">
                Interview
              </option>
              <option value="ESSAY"
                      th:selected="${#strings.toString(course?.courseType)} == 'ESSAY'">Essay
              </option>
              <option value="ALL_INLCUSIVE"
                      th:selected="${#strings.toString(course?.courseType)} == 'ALL_INLCUSIVE'">All
                Inclusive
              </option>
            </select>
            </div>


            <div class="form-group">
              <label>Course Description</label> <input type="text" required
                                                       name="courseDescription" class="form-control"
                                                       id="courseDescription"
                                                       th:value="${course?.courseDescription}"
                                                       placeholder="description of the Course..">

            </div>

            <div class="form-group">
              <label>Course About</label>
              <textarea class="form-control" name="courseAbout"
                        id="courseAbout" rows="8" placeholder="About the Course.."></textarea>
            </div>

            <div class="">
              <label>Choose Course Image</label>
              <div>

                <label class="custom-file"> <input type="file" required
                                                   id="file" class="custom-file-input"> <span
                    class="custom-file-control"></span>
                </label> <input type="button" class="button btn-primary" value="Upload"
                                id="but_upload">
                <div style="display: none;" id="loaderUpload">
                  <img width="30px" height="30px"
                       src="http://www.sbif.cl/recursos/sbifweb3/img/throbber_13.gif">
                </div>

              </div>
              <br/> <img th:src="${course?.courseImageUrl}"
                         id="upload-img-tag" width="100px"/><br/> <a
                th:text="${course?.courseImageUrl}"></a><br/>
              <br/>
            </div>

            <div class="form-group">
              <label>Image Alt Text</label> <input type="text" required
                                                   name="imageAltText" class="form-control"
                                                   id="imageAltText"
                                                   th:value="${course?.imageAltText}"
                                                   placeholder="Enter alt text of the image.....">

            </div>


            <div class="form-group requirement_wrap"
                 style="margin-top: 10px;">

              <label>Course Requirements</label>


              <div class="input-group control-group after-add-more">
                <input type="text" required name="CourseRequirements[]"
                       id="CourseRequirements" class="form-control" maxlength="255"
                       minlength="2" placeholder="Course Requirements....">
                <div class="input-group-btn">

                  <button class="btn btn-success add-more-require"
                          style="width: 104px; border-top-right-radius: 8px; border-bottom-right-radius: 8px;"
                          type="button">
                    <i class="fa fa-plus" aria-hidden="true"></i> Add Field
                  </button>

                </div>
              </div>

              <div class="field_wrapper"></div>
            </div>


            <div class="form-group inclusions_wrap">
              <label>Course Inclusions</label>

              <div class="row">
                <div class="col-md-4">

                  <input type="text" required name="CourseIncludesText[]"
                         id="CourseIncludesText" class="form-control"
                         placeholder="Text" maxlength="255" minlength="2">
                </div>

                <div class="col-md-6">
                  <input type="text" required name="CourseIncludesDescription[]"
                         id="CourseIncludesDescription" class="form-control"
                         placeholder="Description" maxlength="255" minlength="2">
                </div>
                <div class="col-md-1">
                  <button class="btn btn-success add-more"
                          style="width: 104px; border-top-right-radius: 8px; border-bottom-right-radius: 8px;"
                          type="button">
                    <i class="fa fa-plus" aria-hidden="true"></i> Add Fields
                  </button>
                </div>
              </div>
              <div class="field_wrapper1"></div>

            </div>


            <div class="form-group add_info_wrap">
              <label>Course Additional Information</label>

              <div class="row">
                <div class="col-md-4">

                  <input type="text" required name="CourseAdditionalInfoText[]"
                         id="CourseAdditionalInfoText" class="form-control"
                         placeholder="Text" maxlength="150" minlength="2">
                </div>
                <div class="col-md-6">

                  <input type="text" required
                         name="CourseAdditionalInfoDescription[]"
                         id="CourseAdditionalInfoDescription" class="form-control"
                         placeholder="Description" maxlength="255" minlength="2">
                </div>
                <div class="col-md-1">

                  <button class="btn btn-success btn-add"
                          style="width: 104px; border-top-right-radius: 8px; border-bottom-right-radius: 8px;"
                          type="button">
                    <i class="fa fa-plus" aria-hidden="true"></i> Add Fields
                  </button>
                </div>
              </div>
              <div class="field_wrapper2"></div>
            </div>


            <!--<div class="form-group">
              <label>Demo Lecture</label> <input type="url" name="demolecture"
                                                 id="demolecture" class="form-control"
                                                 th:value="${course?.demoLecture}"
                                                 placeholder="Add the Demo lecture..">
            </div>-->
            <div class="form-group">
              <label>No Of Students Currently Enrolled</label> <input
                type="number" min="0" class="form-control"
                name="noOfStudentsCurrentlyEnrolled"
                id="noOfStudentsCurrentlyEnrolled"
                th:value="${course?.studentsEnrolled}"
                placeholder="Enter the no of students Enrolled..">
            </div>

            <div class="form-horizontal">
              <div class="row">

                <div class="">

                  <div class="col-sm-6">
                    <label>Course Rating</label> <input type="number" min="0"
                                                        max="5" class="form-control"
                                                        name="courseRating"
                                                        id="courseRating"
                                                        th:value="${course?.courseRating}"
                                                        placeholder="Enter course rating...">
                  </div>

                  <div class="col-sm-6">
                    <label>No of Reviewers</label> <input type="number" min="0"
                                                          class="form-control" name="noOfReviewers"
                                                          id="noOfReviewers"
                                                          th:value="${course?.noOfReviewers}"
                                                          placeholder="Enter Number of Reviewers rating...">
                  </div>
                </div>
              </div>
            </div>


            <div class="form-group" style="margin-top: 10px;">
              <label>Course ExamSegment</label> <select
                name="courseExamSegment" required id="courseExamSegment"
                class="form-control">


            </select>
            </div>

            <div class="form-group">
              <label>Course Category</label> <select name="courseCategory"
                                                     required id="courseCategory"
                                                     class="form-control">

            </select>
            </div>

            <div class="form-group">
              <label>Course Sub Category</label> <select
                name="courseSubCategory" id="courseSubCategory"
                class="form-control">

            </select>
            </div>

            <div class="form-group">
              <label>Course Subject</label> <select name="subjectList"
                                                    id="subjectList" multiple
                                                    class="form-control selectpicker"
                                                    data-live-search="true"
                                                    title="Select Multiple Subject">
            </select>
            </div>


            <div class="form-group">
              <label>Course Medium</label> <input type="text"
                                                  name="courseMedium" id="courseMedium"
                                                  class="form-control"
                                                  th:value="${course?.courseMedium}"
                                                  placeholder="Enter course medium">
            </div>


            <div class="form-group">
              <label>Course Suitable For</label> <input type="text"
                                                        name="suitableFor" id="suitableFor"
                                                        class="form-control"
                                                        th:value="${course?.suitableFor}"
                                                        placeholder="Course Suitable For....">
            </div>

            <div class="form-horizontal">
              <div class="row">

                <div class="">

                  <div class="col-sm-6">
                    <label>Start Date</label>
                    <div class='input-group datepicker'>
                      <input type='text' class="form-control" name="startDate"
                             th:value="${course?.startDate}" id="startDate" autofocus
                             required/> <span class="input-group-addon"> <span
                        class="glyphicon glyphicon-calendar"></span>
												</span>
                    </div>

                  </div>

                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Course Validity For Display</label> <input type="text"
                                                                name="courseValidity"
                                                                id="courseValidity"
                                                                class="form-control"
                                                                th:value="${course?.courseValidity}"
                                                                placeholder="Enter course validity">
            </div>

            <div class="form-group">
              <label>No of Session</label> <input type="text"
                                                  name="noOfSessions" id="noOfSessions"
                                                  class="form-control"
                                                  th:value="${course?.noOfSessions}"
                                                  placeholder="Enter course medium">
            </div>

            <div class="row" style="margin-top: 10px">
              <div class="">
                <label class="container"><input type="checkbox"
                                                name="popular" th:checked="${course?.popular}"
                                                id="popular">is
                  Popular</label>
              </div>
            </div>

            <div class="form-group">
              <label>Related Courses</label> <select name="related-courses"
                                                     multiple id="related-courses"
                                                     class="form-control related-courses selectpicker"
                                                     data-live-search="true">
              <option value="0">Select multiple related courses</option>

              <option th:each="cp : ${course?.relatedCourses}"
                      th:text="${cp.courseTitle}" th:value="${cp.courseSummaryId}"
                      th:selected="${cp.courseSummaryId}"></option>

              <option th:each="rc : ${relatedCourses}"
                      th:text="${rc.courseTitle}" th:value="${rc.courseSummaryId}"
                      th:if="${#strings.toString(rc?.status)}==publish"></option>

            </select>
            </div>

            <div class="form-group">
              <label>Frequently Bought Together</label> <select
                name="bought_together-courses" multiple
                id="bought_together-courses"
                class="form-control bought-together selectpicker"
                data-live-search="true">
              <option value="0">Select multiple frequently bought
                together courses
              </option>
              <option th:each="cp : ${course?.boughtTogetherCourses}"
                      th:text="${cp.courseTitle}" th:value="${cp.courseSummaryId}"
                      th:selected="${cp.courseSummaryId}"></option>
              <option th:each="rc : ${relatedCourses}"
                      th:text="${rc.courseTitle}" th:value="${rc.courseSummaryId}"
                      th:if="${#strings.toString(rc?.status)}==publish"></option>
            </select>
            </div>


            <div class="panel panel-primary" id="erMetaPanel">
              <div class="panel-heading">Meta Information</div>
              <div class="panel-body">
                <div style="margin-top: 20px;" class="col-md-9">
                  <label> Title:</label> <input type="text"
                                                placeholder="Enter Title" id="titleTag"
                                                class="form-control"
                                                required="required">
                </div>

                <div class="row"></div>
                <div style="margin-top: 20px; margin-bottom: 20px;"
                     class="col-md-9" id="socialImageContainer">
                  <label> Social Image:</label> <br/> <label
                    class="custom-file"> <input type="file" required
                                                id="socialImage" class="custom-file-input"> <span
                    class="custom-file-control"></span>
                </label> <input type="button" class="btn btn-primary" value="Upload"
                                id="but_social_upload">

                  <div style="display: none;" id="loaderSocialUpload">
                    <img width="30px" height="30px"
                         src="https://www.sbif.cl/recursos/sbifweb3/img/throbber_13.gif">
                  </div>
                  <br/> <img src="" id="upload-social-img-tag" width="100px"/>
                </div>
                <br/> <br/>

                <div class="existingMetaPanel">
                  <div class="row" id="existingMetaPanel"
                       style="margin-left: 15px; margin-top: 13px;">
                    <div class="col-md-4">
                      <label style="font-weight: bold;">Meta Type:</label> <input
                        type="text"  value="description" id="metaType">
                    </div>
                    <div class="col-md-4">
                      <label style="font-weight: bold;">Meta Content:</label> <input
                        type="text" id="metaContent"required="required">
                    </div>

                  </div>
                </div>

                <div class="row" id="metaPanel"></div>
                <div class="row">
                  <div style="margin-top: 20px;" class="col-md-9">
                    <button type="button" class="btn btn-primary"
                            onclick="showAddMetaPanel();">Add More MetaData
                    </button>
                  </div>
                </div>

                <div id="addMetaPanel">
                  <div style="margin-top: 20px;" class="col-md-9">
                    <label style="font-weight: bold;"> Meta Type:</label><select
                      class="form-control selectpicker" id="ddMetaType"
                      data-live-search="true">
                    <option value="twitter:card">twitter:card</option>
                    <option value="twitter:description">twitter:description</option>
                    <option value="og:locale">og:locale</option>
                    <option value="twitter:title">twitter:title</option>
                    <option value="twitter:site">twitter:site</option>
                    <option value="og:site_name">og:site_name</option>
                    <option value="article:section">article:section</option>
                    <option value="og:type">og:type</option>
                    <option value="og:description">og:description</option>
                    <option value="fb:app_id">fb:app_id</option>
                    <option value="og:url">og:url</option>
                    <option value="og:image">og:image</option>
                    <option value="og:image:secure_url">og:image:secure_url</option>
                    <option value="article:publisher">article:publisher</option>
                    <option value="og:title">og:title</option>
                  </select>
                  </div>

                  <div style="margin-top: 20px;" class="col-md-9">
                    <label style="font-weight: bold;"> Meta Content:</label> <input
                      type="text" placeholder="Enter comma separated meta content"
                      id="txtMetaContent" class="form-control">
                  </div>

                  <div style="margin-top: 20px;" class="col-md-9">
                    <button type="button" class="btn btn-primary"
                            onclick="addMetaInfo();">Save Meta
                    </button>
                  </div>
                </div>

              </div>
            </div>
            <br/>

            <div class="panel panel-primary" id="pnlFeaturedImage">
              <div class="panel-heading">Featured Image</div>
              <div class="panel-body">

                <div style="margin-top: 20px;" class="col-md-9">
                  <label> Title:</label> <input type="text"
                                                placeholder="Enter featured image title"
                                                id="txtFITitle"
                                                th:value="${course?.featuredImage?.title}"
                                                class="form-control">
                </div>

                <div style="margin-top: 20px;" class="col-md-9">
                  <label> Caption:</label> <input type="text"
                                                  placeholder="Enter featured image caption"
                                                  id="txtFICaption"
                                                  th:value="${course?.featuredImage?.caption}"
                                                  class="form-control">
                </div>

                <div style="margin-top: 20px;" class="col-md-9">
                  <label> Alt Text:</label> <input type="text"
                                                   placeholder="Enter featured image alt text"
                                                   id="txtFIAltText"
                                                   th:value="${course?.featuredImage?.altText}"
                                                   class="form-control">
                </div>

                <div style="margin-top: 20px;" class="col-md-9">
                  <label> Description:</label> <input type="text"
                                                      placeholder="Enter featured image description"
                                                      th:value="${course?.featuredImage?.description}"
                                                      id="txtFIDescription" class="form-control">
                </div>

                <div style="margin-top: 20px;" class="col-md-9">
                  <label>Upload Image:</label></br> <label class="custom-file">
                  <input type="file" required id="featureImage"
                         class="custom-file-input"> <span
                    class="custom-file-control"></span>
                </label> <input type="button" class="button btn-primary"
                                value="Upload" id="but_feature_upload">

                  <div style="display: none;" id="loaderFeatureUpload">
                    <img width="30px" height="30px"
                         src="http://www.sbif.cl/recursos/sbifweb3/img/throbber_13.gif">
                  </div>
                  <img th:src="${course?.featuredImage?.url}"
                       id="upload-feature-img-tag" width="100px"/>
                </div>

              </div>
            </div>


            <!--<div class="panel panel-primary">
              <div class="panel-heading">BreadCrumbs</div>
              <div class="panel-body" id="panel-body">

                <div class="saved-breadcrumb" id="saved-breadCrumb">
                  <div class="form-group">
                    <label style="margin-top: 10px" ;>BreadCrumb Level 1</label>

                    <select name="show-breadCrumb"
                            class="form-control show-breadCrumb"
                            title="Select BreadCrumb">

                      <option selected disabled>Select BreadCrumb</option>

                      <option th:each="breadCrumb : ${breadCrumbs}"
                              th:data-subtext="${breadCrumb.link}"
                              th:text="${breadCrumb.text}"
                              th:value="${breadCrumb.breadcrumbId}"></option>

                    </select>


                  </div>
                </div>

                <button type="button" class="btn btn-default create-breadcrumb"
                        style="margin-top: 2px" onclick="createBreadCrumb()">
                  <span class="glyphicon glyphicon-plus-sign"></span> Create
                  BreadCrumb
                </button>

              </div>
            </div>-->

            <br/> <label class="radio-inline" style="margin-top: 10px;"><input
              type="radio" value="publish"
              th:checked="${#strings.toString(course?.status)} == 'publish'"
              name="status" checked>Publish</label> <label
              class="radio-inline" style="margin-top: 10px;"><input
              type="radio" value="draft"
              th:checked="${#strings.toString(course?.status)} == 'draft'"
              name="status">Draft</label>


            <div class="row">
              <div class="col-md-9" style="margin-top: 20px;">
                <button class="submit btn btn-success" type="submit"
                        id="btnSubmit" value="submit">Submit
                </button>
                <i class="fa fa-spinner fa-spin" id="loader"></i> <a
                  href="/admin_lmsadmin/lms/courses" class="btn btn-default"
                  style="margin-left: 60px;">All Course</a>
              </div>
            </div>


          </div>
        </div>
      </form>


    </div>
  </div>
  </form>
</div>
</div>

</div>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<!--/*/
<th:block th:include="admin/footer"></th:block>
/*/-->
<script
    src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script
    src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js"></script>
<script
    th:src="@{${@mvcResourceUrlProvider.getForLookupPath('/admin/dist/js/bootstrap-maxlength.js')}}"></script>
<script th:inline="javascript">
  /*<![CDATA[*/

  var courseAbout = [[${course?.courseAbout}]];
  var courseRequirements = [[${course?.courseRequirements}]];
  var courseInclusions = [[${course?.courseInclusions}]];
  var courseAdditionalInformation = [[${course?.courseAdditional}]];
  var examSegment = [[${course?.courseExamSegment}]];
  var courseCategory = [[${course?.courseCategory}]];
  var courseSubCategory = [[${course?.courseSubCategory}]];
  var courseImageUrl = [[${course?.courseImageUrl}]];
  var courseImage = [[${course?.courseImage}]];
  var breadCrumb = [[${course?.breadCrumb}]];
  var courseId = [[${course?.id}]]
  var featureImageUrl = [[${course?.featuredImage?.url}]];
  var featureImageName = [[${course?.featuredImage?.name}]];
  var metaList = [[${course?.metaList}]];
  var courseSubject = [[${course?.courseSubject}]];
  /*]]>*/
</script>
<script>

  var mapRelatedCourse = {};
  var mapFrequentlyBought = {};
  var metaInfoList = [];

  function initMaxLengthForIncludes() {
    $('input#CourseIncludesText').maxlength({
      alwaysShow: true,
      warningClass: "label label-info",
      limitReachedClass: "label label-warning",
      placement: 'top',
      message: 'used %charsTyped% of %charsTotal% chars.',
      validate: true,
      appendToParent: true
    });

    $('input#CourseIncludesDescription').maxlength({
      alwaysShow: true,
      warningClass: "label label-info",
      limitReachedClass: "label label-warning",
      placement: 'top',
      message: 'used %charsTyped% of %charsTotal% chars.',
      validate: true,
      appendToParent: true
    });
  }

  $("#but_social_upload")
  .click(
      function () {
        $('#loaderSocialUpload').show();
        $('#but_social_upload').hide();

        var files = $('#socialImage')[0].files[0];
        var fd = new FormData();
        fd.append('file', files);
        fd.append('type', "socialImage/post");
        fd.append('contentType', files.type);

        uploadFile(
            fd,
            function (response) {
              if (response != null) {
                getImageUrl(
                    response,
                    function (imageUrlResponse) {

                      if (imageUrlResponse != null) {
                        $('#loaderSocialUpload')
                        .hide();
                        var reader = new FileReader();
                        reader.onload = function (e) {
                          $(
                              '#upload-social-img-tag')
                          .attr(
                              'src',
                              e.target.result);

                        };
                        reader
                        .readAsDataURL($('#socialImage')[0].files[0]);
                        postSocialImageUrl = imageUrlResponse;
                        if ($("#upload-social-img-tag").length > 0) {

                          var mydiv = document.getElementById("socialImageContainer");
                          var aTag = document.createElement('a');
                          aTag.setAttribute('href', postSocialImageUrl);
                          aTag.setAttribute('id', "social-image-url");
                          aTag.innerHTML = postSocialImageUrl;
                          mydiv.appendChild(aTag);

                        }
                        else {
                          var mydiv = document.getElementById("socialImageContainer");
                          var aTag = document.createElement('a');
                          aTag.setAttribute('href', imageUrlResponse);
                          aTag.setAttribute('id', "social-image-url");
                          aTag.innerHTML = imageUrlResponse;
                          mydiv.appendChild(aTag);
                        }

                      } else {
                        $('#loaderSocialUpload')
                        .hide();
                        $('#but_social_upload')
                        .show();
                      }
                    });

              }

              else {
                $('#loaderSocialUpload').hide();
                $('#but_social_upload').show();
              }

            });

      });

  function initMaxLengthForAdditional() {
    $('input#CourseAdditionalInfoText').maxlength({
      alwaysShow: true,
      warningClass: "label label-info",
      limitReachedClass: "label label-warning",
      placement: 'top',
      message: 'used %charsTyped% of %charsTotal% chars.',
      validate: true
    });

    $('input#CourseAdditionalInfoDescription').maxlength({
      alwaysShow: true,
      warningClass: "label label-info",
      limitReachedClass: "label label-warning",
      placement: 'top',
      message: 'used %charsTyped% of %charsTotal% chars.',
      validate: true
    });
  }

  $(document).ready(function () {
    $('#courseAbout').val(courseAbout);
    $('#startDate').datepicker({
      format: 'dd/mm/yyyy',
      autoclose: true,
      todayHighlight: true
    });


    $('#addMetaPanel').hide();
    $('#metaPanel').hide();

    $('.related-courses option').each(function () {
      if (mapRelatedCourse[this.value]) {
        $(this).remove()
      }
      mapRelatedCourse[this.value] = true;
    });

    $('.bought-together option').each(function () {
      if (mapFrequentlyBought[this.value]) {
        $(this).remove()
      }
      mapFrequentlyBought[this.value] = true;
    });

    if (courseInclusions != null && courseInclusions.length>0) {
      courseInclusions.forEach(function (element, index) {

        if (index == 0) {
          $('#CourseIncludesText').val(element.text);
          $('#CourseIncludesDescription').val(element.description);
        }

        else {
          var fieldHTML = '<div class="row">\n'
              + '                                    <div class="col-md-4">\n'
              + '\n'
              + '                                        <input type="text" required name="CourseIncludesText[]" id="CourseIncludesText" value="#CourseIncludesText#" class="form-control"\n'
              +
              '                                               placeholder="Text" maxlength="255" minlength="2">\n'
              + '                                    </div>\n'
              + '\n'
              + '                                    <div class="col-md-6">\n'
              + '                                        <input type="text" required name="CourseIncludesDescription[]" id="CourseIncludesDescription" value="#CourseIncludesDescription#" class="form-control"\n'
              +
              '                                               placeholder="Description" maxlength="255" minlength="2">\n'
              + '                                    </div>\n'
              + '                                    <div class="col-md-1">\n'
              + '                                        <button class="btn btn-danger remove-btn"  style="width: 100px;padding-left: 2px;padding-right: 100px;border-top-right-radius: 8px;border-bottom-right-radius: 8px;" type="button"><i class="fa fa-times" aria-hidden="true"></i> Remove Field</button>\n'
              + '                                    </div>\n'
              + '                                </div>';

          fieldHTML = fieldHTML.replace("#CourseIncludesText#", element.text);
          fieldHTML = fieldHTML.replace("#CourseIncludesDescription#",
              element.description);

          $('.field_wrapper1').append(fieldHTML);
        }
      });
    }

    if(courseAdditionalInformation!=null && courseAdditionalInformation.length>0) {
      courseAdditionalInformation.forEach(function (element, index) {

        if (index == 0) {
          $('#CourseAdditionalInfoText').val(element.text);
          $('#CourseAdditionalInfoDescription').val(element.description);
        }

        else {
          var fieldHTML = '<div class="row">\n'
              + '                                <div class="col-md-4">\n'
              + '\n'
              + '                                    <input type="text" required name="CourseAdditionalInfoText[]" id="CourseAdditionalInfoText" value="#CourseAdditionalInfoText#" class="form-control"\n'
              +
              '                                           placeholder="Text" maxlength="255" minlength="2">\n'
              + '                                </div>\n'
              + '                                <div class="col-md-6">\n'
              + '\n'
              + '                                    <input type="text" required name="CourseAdditionalInfoDescription[]" id="CourseAdditionalInfoDescription" value="#CourseAdditionalInfoDescription#" class="form-control"\n'
              +
              '                                           placeholder="Description" maxlength="255" minlength="2">\n'
              + '                                </div>\n'
              + '                                <div class="col-md-1">\n'
              + '\n'
              + '                                    <button class="btn btn-danger remove" style="width: 100px;padding-left: 2px;padding-right: 100px;border-top-right-radius: 8px;border-bottom-right-radius: 8px;" type="button"><i class="fa fa-times" aria-hidden="true"></i> Remove Field</button>'
              + '                                </div>\n'
              + '                            </div>';

          fieldHTML = fieldHTML.replace("#CourseAdditionalInfoText#", element.text);
          fieldHTML = fieldHTML.replace("#CourseAdditionalInfoDescription#",
              element.description);

          $('.field_wrapper2').append(fieldHTML);
        }
      });
    }
    getExamSegment();
    initMaxLengthForIncludes();
    initMaxLengthForAdditional();

  });

  $('input#courseTitle').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#courseName').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#demolecture').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#courseMedium').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#suitableFor').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#txtFITitle').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#txtFICaption').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#txtFIAltText').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#txtFIDescription').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $('input#CourseRequirements').maxlength({
    alwaysShow: true,
    warningClass: "label label-info",
    limitReachedClass: "label label-warning",
    placement: 'top',
    message: 'used %charsTyped% of %charsTotal% chars.',
    validate: true
  });

  $("#teacherInstitute").change(function (event) {
    es = $(this).val();
    getTeachersByInstitute(es)
  });

  function getTeachersByInstitute(instituteId) {
    $
    .ajax({
      type: 'GET',
      async: false,
      dataType: 'json',
      url: apiBasePath + "/institutes/" + instituteId,
      success: function (response) {
        $('#loaderInstitute').hide();
        var htmlToShow = '<option value="0" disabled>Select Teacher(s)</option>';
        var teachersList = '<option value="#userId#">#teacherName#</option>';
        if (response.teachers.length > 0) {
          $.each(response.teachers, function (index,
              element) {
            i = index + 1;
            htmlToShow = htmlToShow += teachersList;
            htmlToShow = htmlToShow.replace(
                /#userId#/g, element.id);
            htmlToShow = htmlToShow.replace(
                "#teacherName#",
                element.teacherName);
            htmlToShow = htmlToShow.replace("#slug#",
                element.slug);
          });
          $('#courseInstructorId').html(htmlToShow);
        } else {
          $('#courseInstructorId').html("");
        }
      },

      error: function (response) {
        alert("No teacher found by that institute");
      }
    });
    $('#courseInstructorId').selectpicker('refresh');
  }

  function getExamSegment() {
    $
    .ajax({
      type: 'GET',
      dataType: 'json',
      url: apiBasePath + "/examsegments",

      success: function (response) {
        var htmlToShow = '<option value="0">Select Exam Segment</option>';
        var examSegmentList = '<option value="#key#" >#value#</option>';
        if (response!=null) {
          $.each(response, function (key, value) {
            htmlToShow = htmlToShow += examSegmentList;

            htmlToShow = htmlToShow.replace(/#key#/g,
                key);

            htmlToShow = htmlToShow.replace(/#value#/g,
                value);

          });
          $('#courseExamSegment').html(htmlToShow);

        } else {
          $('#courseExamSegment').html("");
        }

        if (examSegment != null) {
          $('#courseExamSegment').val(examSegment).change();
        }

      },

      error: function (response) {

      }
    });
  }

  function getCategoryByExamSegment(category) {
    $
    .ajax({
      type: 'GET',
      dataType: 'json',

      url: apiBasePath + "/examsegments/category/"
          + category,
      success: function (response) {
        var htmlToShow = '<option value="0">Select Course Category</option>';
        var categoryList = '<option value="#key#">#value#</option>';
        if (response!=null) {
          $.each(response, function (key, value) {
            htmlToShow = htmlToShow += categoryList;
            htmlToShow = htmlToShow.replace(/#key#/g,
                key);

            htmlToShow = htmlToShow.replace(/#value#/g,
                value);

          });
          $('#courseCategory').html(htmlToShow)
          .removeAttr('disabled');

        } else {
          $('#courseCategory').html("");
        }

        if (courseCategory != null) {
          $('#courseCategory').val(courseCategory).change();
        }
      },

      error: function (response) {

      }
    });
  }

  $("#courseExamSegment").change(function (event) {
    es = $(this).val();
    examSegment = null;
    getCategoryByExamSegment(es);
  });

  function getSubCategoryByExamSegment(examSegment, category) {
    $
    .ajax({
      type: 'GET',
      dataType: 'json',
      url: apiBasePath + "/examsegments/" + examSegment
          + "/category/" + category,
      success: function (response) {
        var htmlToShow = '<option value="0">Select Course SubCategory</option>';
        var subCategoryList = '<option value="#key#">#value#</option>';
        if (response!=null) {
          $.each(response, function (key, value) {
            htmlToShow = htmlToShow += subCategoryList;
            htmlToShow = htmlToShow.replace(/#key#/g,
                key);
            htmlToShow = htmlToShow.replace(/#value#/g,
                value);

          });
          $('#courseSubCategory').html(htmlToShow)
          .removeAttr('disabled');

        } else {
          $('#courseSubCategory').html("");
        }
        if (courseSubCategory != null) {
          $('#courseSubCategory').val(courseSubCategory).change();
        }

      },

      error: function (response) {

      }
    });
  }

  $("#courseCategory").change(function () {
    es = $("#courseExamSegment").val();
    cat = $(this).val();
    courseCategory = null;
    getSubCategoryByExamSegment(es, cat);
  });

  $("#courseSubCategory").change(function () {
    es = $("#courseExamSegment").val();
    cat = $("#courseCategory").val();
    subCat = $(this).val();
    courseSubCategory = null;
    getSubjectsBySubCategory(es, cat, subCat);
  });

  function getSubjectsBySubCategory(examSegment, category, subCategory) {
    $
    .ajax({
      async: true,
      type: 'GET',
      dataType: 'json',
      url: apiBasePath + "/examsegments/" + examSegment
          + "/category/" + category + "/subcatgory/" + subCategory,
      success: function (response) {
        var htmlToShow = '<option value="0" disabled>Select Course Subjects</option>';
        var subjects = '<option value="#name#">#name#</option>';
        if (response.length > 0) {
          $.each(response, function (index, element) {
            i = index + 1;
            htmlToShow = htmlToShow += subjects;
            htmlToShow = htmlToShow.replace(/#name#/g,
                element);

          });
          $('#subjectList').html(htmlToShow);
          $('#subjectList').selectpicker('refresh');

        } else {
          $('#subjectList').html("");
          $('#subjectList').selectpicker('refresh');
        }

        if (courseSubject != null) {
          var courseSubjectArray = courseSubject.split(',');

          $.each(courseSubjectArray, function (index, element) {
            $("#subjectList option[value='" + element + "']").prop("selected", true);
          })
          courseSubject = null;
        }
        $('#subjectList').selectpicker('refresh');
      },

      error: function (response) {

      }
    });
  }

  $('.btn-add')
  .click(
      function () {

        blank = false;
        $(".add_info_wrap input").each(
            function (index, elm) {
              if ($(elm).val() == "") {
                blank = true;
              }
            });

        if (!blank) {
          var fieldHTML = '<div class="row">\n'
              + '                                <div class="col-md-4">\n'
              + '\n'
              + '                                    <input type="text" required name="CourseAdditionalInfoText[]" id="CourseAdditionalInfoText" class="form-control"\n'
              +
              '                                           placeholder="Text" maxlength="255" minlength="2">\n'
              + '                                </div>\n'
              + '                                <div class="col-md-6">\n'
              + '\n'
              + '                                    <input type="text" required name="CourseAdditionalInfoDescription[]" id="CourseAdditionalInfoDescription" class="form-control"\n'
              +
              '                                           placeholder="Description" maxlength="255" minlength="2">\n'
              + '                                </div>\n'
              + '                                <div class="col-md-1">\n'
              + '\n'
              + '                                    <button class="btn btn-danger remove" style="width: 100px;padding-left: 2px;padding-right: 100px;border-top-right-radius: 8px;border-bottom-right-radius: 8px;" type="button"><i class="fa fa-times" aria-hidden="true"></i> Remove Field</button>'
              + '                                </div>\n'
              + '                            </div>';

          $('.field_wrapper2').append(fieldHTML);
        }
      });

  $('.field_wrapper2').on('click', '.remove', function () {
    $(this).parent().parent('div').remove();

  });

  $('.add-more')
  .click(
      function () {
        blank = false;
        $(".inclusions_wrap input").each(
            function (index, elm) {
              if ($(elm).val() == "") {
                blank = true;
              }
            });

        if (!blank) {
          var fieldHTML = '<div class="row">\n'
              + '                                    <div class="col-md-4">\n'
              + '\n'
              + '                                        <input type="text" required name="CourseIncludesText[]" id="CourseIncludesText" class="form-control"\n'
              +
              '                                               placeholder="Text" maxlength="255" minlength="2">\n'
              + '                                    </div>\n'
              + '\n'
              + '                                    <div class="col-md-6">\n'
              + '                                        <input type="text" required name="CourseIncludesDescription[]" id="CourseIncludesDescription" class="form-control"\n'
              +
              '                                               placeholder="Description" maxlength="255" minlength="2">\n'
              + '                                    </div>\n'
              + '                                    <div class="col-md-1">\n'
              + '                                        <button class="btn btn-danger remove-btn"  style="width: 100px;padding-left: 2px;padding-right: 100px;border-top-right-radius: 8px;border-bottom-right-radius: 8px;" type="button"><i class="fa fa-times" aria-hidden="true"></i> Remove Field</button>\n'
              + '                                    </div>\n'
              + '                                </div>';

          $('.field_wrapper1').append(fieldHTML);
        }
      });

  $('.field_wrapper1').on('click', '.remove-btn', function () {
    $(this).parent().parent('div').remove();

  });

  $('.add-more-require')
  .click(
      function () {
        blank = false;
        $(".requirement_wrap input").each(
            function (index, elm) {
              if ($(elm).val() == "") {
                blank = true;
              }
            })
        if (!blank) {
          var fieldHTML = '<div class="input-group control-group after-add-more">\n'
              + '                                <input type="text" required name="CourseRequirements[]"  class="form-control" placeholder="Course Requirements....">\n'
              + '                                <div class="input-group-btn">\n'
              + '\n'
              + '                                          <button class="btn btn-danger remove-require-btn" style="width: 100px;padding-left: 2px;padding-right: 100px;border-top-right-radius: 8px;border-bottom-right-radius: 8px;" type="button"><i class="fa fa-times" aria-hidden="true"></i> Remove Field</button>\n'
              + '\n'
              + '                                </div>\n'
              + '                            </div>';
          $('.field_wrapper').append(fieldHTML);
        }

      });

  $('.field_wrapper').on('click', '.remove-require-btn', function () {
    $(this).parent().parent('div').remove();

  });

  $('.field_wrapper2').on(
      'click',
      '.all',
      function () {
        var $this = $(this);
        if ($this.is(":checked")) {
          $this.parents('.list-group').find("[type=checkbox]")
          .prop("checked", true);
        } else {
          $this.parents('.list-group').find("[type=checkbox]")
          .prop("checked", false);
          $this.prop("checked", false);
        }

      });

  $('#btnSubmit').on('click', function (event) {
    event.preventDefault();
    $('#loader').show();
    submitRequest()

  });

  function submitRequest() {
    if (document.getElementById('popular').checked) {
      $('#free').attr('checked', true);
      $('input[name="popular"]').val(true);
    } else {
      $('#free').attr('checked', false);
      $('input[name="popular"]').val(false);
    }

    var featuredImageReq = {};

    featuredImageReq["url"] = featureImageUrl;
    featuredImageReq["name"] = featureImageName;
    featuredImageReq["title"] = $('#txtFITitle').val();
    featuredImageReq["caption"] = $('#txtFICaption').val();
    featuredImageReq["altText"] = $('#txtFIAltText').val();
    featuredImageReq["description"] = $('#txtFIDescription').val();
    //Updating the social image url

    if (metaInfoList != null && metaInfoList.length > 0) {
      var found = false;
      $.each(metaInfoList, function (index, element) {
        if (element != null && (element.type == "og:image" || element.type == "og:image:secure_url"
            || element.type == "twitter:image")) {
          element.content = postSocialImageUrl;
          found = true;

        }
      });
      if (!found) {
        var metaImg = {};

        metaImg["type"] = "og:image";
        metaImg["content"] = postSocialImageUrl;
        metaImg["attributeType"] = "property";

        metaInfoList.push(metaImg);

        metaImg["type"] = "og:image:secure_url";

        metaInfoList.push(metaImg);

        metaImg["type"] = "twitter:image";
        metaImg["attributeType"] = "name";

        metaInfoList.push(metaImg);
      }
    }

    if (breadCrumbParentId == null && breadCrumb != null) {
      breadCrumbParentId = breadCrumb.breadcrumbId;
    }
    $.each(metaInfoList, function (index, element) {
      if ($('#' + element.type).val() != null && $('#' + element.type).val() != '') {
        element.content = $('#' + element.type).val();
      }
    });
    var input = {

      courseTitle: $('#courseTitle').val(),
      courseName: $('#courseName').val(),
      courseDescription: $('#courseDescription').val(),
      courseImage: courseImage,
      courseImageUrl: courseImageUrl,
      instructors: getInstructor(),
      courseType: $('#courseType').val() != "" ? $('#courseType').val() : null,
      instructorName: $('#instructorName').val(),
      courseRating: $('#courseRating').val(),
      noOfReviewers: $('#noOfReviewers').val(),
      courseSubject: getSubject(),
      courseAbout: $('#courseAbout').val(),
      inclusion: getCourseInclusion().length==0?null:JSON.stringify(getCourseInclusion()),
      additionalInfo: getCourseAddInfo().length==0?null:JSON.stringify(getCourseAddInfo()),
      studentsEnrolled: $('#noOfStudentsCurrentlyEnrolled').val(),
      demoLecture: $('#demolecture').val(),
      courseExamSegment: $('#courseExamSegment').val() != "" ? $('#courseExamSegment').val() : null,
      courseCategory: $('#courseCategory').val() != "" ? $('#courseCategory').val() : null,
      courseSubCategory: $('#courseSubCategory').val() != "" ? $('#courseSubCategory').val() : null,
      courseOldSlug: $('#slug').val(),
      institute: {
        id: $('#teacherInstitute').val()
      },
      courseMedium: $('#courseMedium').val(),
      suitableFor: $('#suitableFor').val(),
      startDate: $('#startDate').val(),
      instituteName: $('#instituteName').val(),
      noOfSessions: $('#noOfSessions').val(),
      courseValidity: $('#courseValidity').val(),
      status: $('input[name=status]:checked', '#cloneCourse').val(),
      popular: $('#popular').val(),
      relatedCourses: getRelatedCourses(),
      boughtTogetherCourses: getBoughtTogetherCourses(),
      featuredImage: featuredImageReq,
      breadCrumb: {
        breadcrumbId: breadCrumbParentId
      },
      metaList: getUpdatedMetaList(),
      titleTag: $('#titleTag').val(),
      imageAltText: $('#imageAltText').val()

    };

    $.ajax({
      url: apiBasePath + "/admin_lmsadmin/courses",
      type: "POST",
      data: JSON.stringify(input),
      contentType: "application/json",
      processData: false,

      success: function (response) {
        $('#loader').hide();
        location.reload();
        alert("Course Add successfully");

      },

      error: function (response) {
        $('#loader').hide();
        alert("Course add failed");
      }
    });

  }

  function getRelatedCourses() {
    list = [];

    $("#related-courses").val().forEach(function (value, index) {
      list.push({
        courseSummaryId: value
      });
    });

    return list;
  }

  function getBoughtTogetherCourses() {
    list = [];

    $("#bought_together-courses").val().forEach(function (value, index) {
      list.push({
        courseSummaryId: value
      });
    });

    return list;
  }

  function getCourseInclusion() {
    list = [];
    $(".inclusions_wrap .row").each(function (index, elm) {
      text = $(elm).find("#CourseIncludesText").val();
      description = $(elm).find("#CourseIncludesDescription").val();

      if(text!="" && description!="") {
        var input = {
          text: text,
          description: description
        };

        list.push(input);
      }
    });
    return list;
  }

  function getCourseAddInfo() {
    list = [];
    $(".add_info_wrap .row").each(
        function (index, elm) {
          text = $(elm).find("#CourseAdditionalInfoText").val();
          description = $(elm).find(
              "#CourseAdditionalInfoDescription").val();

          if(text!="" && description!="") {
            var input = {
              text: text,
              description: description
            };
            list.push(input);
          }
        });
    return list;
  }

  function getInstructor() {
    list = [];

    $("#courseInstructorId").val().forEach(function (value, index) {
      list.push({
        id: value
      });
    });

    return list;
  }

  function getSubject() {
    list = [];

    $("#subjectList").val().forEach(function (value, index) {
      list.push(value);
    });

    return list.join();
  }

  $("#but_upload").click(function () {

    $('#loaderUpload').show();

    var files = $('#file')[0].files[0];
    var fd = new FormData();
    fd.append('file', files);
    fd.append('type', "courses");
    fd.append('contentType', files.type);

    uploadFile(fd, function (response) {
      if (response != null) {
        alert("Upload File " + response + " " + "successfully");
        getImageUrl(response, function (imageUrlResponse) {

          if (imageUrlResponse != null) {
            $('#loaderUpload').hide();
            var reader = new FileReader();
            reader.onload = function (e) {
              $('#upload-img-tag').attr('src', e.target.result);
            };
            courseImage = $('#file')[0].files[0].name;
            reader.readAsDataURL($('#file')[0].files[0]);
            courseImageUrl = imageUrlResponse;

          }
          else {
            $('#loaderUpload').hide();

          }
        });

      }

      else {
        $('#loaderUpload').hide();

      }

    });

  });

  function showAddMetaPanel() {
    $('#addMetaPanel').show();
  }

  function addMetaInfo() {

    var htmlToShow = '<div class="row" id="existingMetaPanel" style="margin-left: 15px; margin-top: 13px;">\n'
        + '                  <div class="col-md-4">\n'
        + '                    <label style="font-weight: bold;">Meta Type:</label> <input type="text" readonly="readonly" id="metaType" value="#type#">\n'
        + '                  </div>\n'
        + '                  <div class="col-md-8">\n'
        + '                    <label style="font-weight: bold;">Meta Content:</label> <input style="width: 70%;" type="text" value="#content#" id="metaContent">\n'
        + '                  </div>\n'
        + '                </div>';


    htmlToShow = htmlToShow.replace("#type#", $('#ddMetaType').val());
    htmlToShow = htmlToShow.replace("#content#", $('#txtMetaContent').val());

    $('.existingMetaPanel').append(htmlToShow);
    $('#addMetaPanel').hide();

    $('#ddMetaType').prop('selectedIndex', 0);
    $('#txtMetaContent').prop('value', '');
  }

  function showMetaDetails() {
    htmlToShow = '';
    htmlBeg = '<div class="row">';
    htmlRow = '<div style="margin-top: 20px;" class="col-md-9">	<label id="lblType" style="font-weight:  bold;"> Meta Type:&nbsp;&nbsp;</label ><input type="text" value="#metaType#" readonly="readonly" style="border-bottom:  0; border-top: 0; border-left:  0; border-right:  0;"></div><div style="margin-top: 20px;" class="col-md-9"><label id="lblContent" style="font-weight:  bold;"> Meta Content:&nbsp;&nbsp;</label> <input type="text" value="#metaContent#" readonly="readonly" style="border-bottom:  0; border-top: 0; border-left:  0; border-right:  0;"></div>';
    htmlEnd = '</div><br/>';

    if (metaInfoList != null && metaInfoList.length > 0) {
      htmlToShow += htmlBeg;

      $.each(metaInfoList,
          function (index, element) {
            htmlToShow += htmlRow;

            htmlToShow = htmlToShow.replace("#metaType#",
                element.type);
            htmlToShow = htmlToShow.replace("#metaContent#",
                element.content);
          });
      htmlToShow += htmlEnd;

      $('#metaPanel').html(htmlToShow).show();
    }

  }

  $("#but_feature_upload").click(function () {
    $('#loaderFeatureUpload').show();

    var files = $('#featureImage')[0].files[0];
    var fd = new FormData();
    fd.append('file', files);
    fd.append('type', "featureImage/courses");
    fd.append('contentType', files.type);

    uploadFile(fd, function (response) {
      if (response != null) {
        getImageUrl(response, function (imageUrlResponse) {

          if (imageUrlResponse != null) {
            $('#loaderFeatureUpload').hide();
            var reader = new FileReader();
            reader.onload = function (e) {
              $('#upload-feature-img-tag').attr('src', e.target.result);
            };
            featureImageName = $('#featureImage')[0].files[0].name;
            reader.readAsDataURL($('#featureImage')[0].files[0]);
            featureImageUrl = imageUrlResponse;
          }
          else {
            $('#loaderFeatureUpload').hide();
          }
        });

      }

      else {
        $('#loaderFeatureUpload').hide();

      }

    });

  });

  function slugExistence(event, value, slugType) {
    event.preventDefault();
    if (event.keyCode == 13) {
      $
      .ajax({
        async: true,
        type: 'GET',
        url: apiBasePath + "/slug/" + value + "/type/" + slugType + "/exist",
        processData: false,
        success: function (response) {

          if (!response) {

            $("div#errMsg").css("color", "green");
            $("div#errMsg").html("Slug is available");
          }

          else {
            $("div#errMsg").css("color", "red");
            $("div#errMsg").html("Slug is not available");
          }
        },

        error: function (response) {
          $("div#errMsg").css("color", "red");
          $("div#errMsg").html("Slug is not available");
        }
      });
    }

  }
  function getUpdatedMetaList() {
    list = [];
    $(".existingMetaPanel .row").each(function (index, elm) {

      metaType = $(elm).find("#metaType").val();
      metaContent = $(elm).find("#metaContent").val();

      if (metaType.includes("og")) {
        attributeType = 'property';
      }
      else {
        attributeType = 'name';
      }

      var input = {
        type: metaType,
        content: metaContent,
        attributeType: attributeType
      };

      list.push(input);
    });

    return list;
  }

</script>

</body>
</html>